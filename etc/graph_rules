#!/bin/sh

TIME=`date +%s`
RED_CMD="redis-cli"

$RED_CMD -x SET graph_int_rules <<EOM
int.ifAdminStatus == 1
EOM

#int.ifAdminStatus == 1 && (
#  int.ifName =~ /^vl|^lte1|^tu[0-9]/ ||
#  int.ifAlias =~ /alert|graph|trunk|uplink|downlink|power|inet|lan|dmz/ ||
#  int.portMode == 2 ||
#  not_empty int.l2_links ||
#  not_empty int.ips
#)

$RED_CMD <<EOM
MULTI
DEL graph_create
HSET graph_create time $TIME
HSET graph_create ifInOctets "-s 60 -O DS:in:COUNTER:120:0:50000000000 RRA:AVERAGE:0.5:1:133920 RRA:AVERAGE:0.5:10:26784 RRA:AVERAGE:0.5:60:8928"
HSET graph_create ifOutOctets "-s 60 -O DS:out:COUNTER:120:0:50000000000 RRA:AVERAGE:0.5:1:133920 RRA:AVERAGE:0.5:10:26784 RRA:AVERAGE:0.5:60:8928"
HSET graph_create ifHCInOctets "-s 60 -O DS:in:COUNTER:120:0:50000000000 RRA:AVERAGE:0.5:1:133920 RRA:AVERAGE:0.5:10:26784 RRA:AVERAGE:0.5:60:8928"
HSET graph_create ifHCOutOctets "-s 60 -O DS:out:COUNTER:120:0:50000000000 RRA:AVERAGE:0.5:1:133920 RRA:AVERAGE:0.5:10:26784 RRA:AVERAGE:0.5:60:8928"
HSET graph_create ifInUnicastPkts "-s 60 -O DS:inucst:COUNTER:120:0:10000000 RRA:AVERAGE:0.5:1:133920 RRA:AVERAGE:0.5:10:26784 RRA:AVERAGE:0.5:60:8928"
HSET graph_create ifOutUnicastPkts "-s 60 -O DS:outucst:COUNTER:120:0:10000000 RRA:AVERAGE:0.5:1:133920 RRA:AVERAGE:0.5:10:26784 RRA:AVERAGE:0.5:60:8928"
HSET graph_create ifInMulticastPkts "-s 60 -O DS:inmcst:COUNTER:120:0:10000000 RRA:AVERAGE:0.5:1:133920 RRA:AVERAGE:0.5:10:26784 RRA:AVERAGE:0.5:60:8928"
HSET graph_create ifOutMulticastPkts "-s 60 -O DS:outmcst:COUNTER:120:0:10000000 RRA:AVERAGE:0.5:1:133920 RRA:AVERAGE:0.5:10:26784 RRA:AVERAGE:0.5:60:8928"
HSET graph_create ifInBroadcastPkts "-s 60 -O DS:inbcst:COUNTER:120:0:10000000 RRA:AVERAGE:0.5:1:133920 RRA:AVERAGE:0.5:10:26784 RRA:AVERAGE:0.5:60:8928"
HSET graph_create ifOutBroadcastPkts "-s 60 -O DS:outbcst:COUNTER:120:0:10000000 RRA:AVERAGE:0.5:1:133920 RRA:AVERAGE:0.5:10:26784 RRA:AVERAGE:0.5:60:8928"
HSET graph_create ifInErrors "-s 60 -O DS:inerr:COUNTER:120:0:10000000 RRA:AVERAGE:0.5:1:133920 RRA:AVERAGE:0.5:10:26784 RRA:AVERAGE:0.5:60:8928"
HSET graph_create ifInCRCErrors "-s 60 -O DS:incrc:COUNTER:120:0:10000000 RRA:AVERAGE:0.5:1:133920 RRA:AVERAGE:0.5:10:26784 RRA:AVERAGE:0.5:60:8928"
HSET graph_create ifOperStatus "-s 60 -O DS:os:GAUGE:120:U:U RRA:MAX:0.5:1:133920 RRA:MAX:0.5:10:26784 RRA:MAX:0.5:60:8928"
HSET graph_create oltRxPower "-s 60 -O DS:oltrx:GAUGE:120:U:U RRA:MIN:0.5:1:133920 RRA:MIN:0.5:10:26784 RRA:MIN:0.5:60:8928"
HSET graph_create onuRxPower "-s 60 -O DS:onurx:GAUGE:120:U:U RRA:MIN:0.5:1:133920 RRA:MIN:0.5:10:26784 RRA:MIN::0.5:60:8928"
HSET graph_create onuDistance "-s 60 -O DS:onudist:GAUGE:120:U:U RRA:MAX:0.5:1:133920 RRA:MAX:0.5:10:26784 RRA:MAX:0.5:60:8928"
HSET graph_create cpu1MinLoad "-s 60 -O DS:cpu1min:GAUGE:120:U:U RRA:MAX:0.5:1:133920 RRA:MAX:0.5:10:26784 RRA:MAX:0.5:60:8928"
HSET graph_create CiscoCPU1mLoad "-s 60 -O DS:cpu1min:GAUGE:120:U:U RRA:MAX:0.5:1:133920 RRA:MAX:0.5:10:26784 RRA:MAX:0.5:60:8928"
HSET graph_create CiscoQFPLoad "-s 60 -O DS:cpu1min:GAUGE:120:U:U RRA:MAX:0.5:1:133920 RRA:MAX:0.5:10:26784 RRA:MAX:0.5:60:8928"
HSET graph_create hwEntCPULoad "-s 60 -O DS:cpu1min:GAUGE:120:U:U RRA:MAX:0.5:1:133920 RRA:MAX:0.5:10:26784 RRA:MAX:0.5:60:8928"
HSET graph_create memoryUsed "-s 60 -O DS:memUse:GAUGE:120:U:U RRA:MAX:0.5:1:133920 RRA:MAX:0.5:10:26784 RRA:MAX:0.5:60:8928"
EXEC
EOM
